(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const s=document;s.getElementById("container");const S=s.getElementById("zona-select"),m=s.querySelector(".clock-input");let g,h=[];function $(){const e=O();e&&!h.includes(e)&&(h.push(e),q(e))}function O(){const e=S.value;return e===""?(m.innerHTML="<p>Por favor seleccione una zona horaria</p>",null):(g=e,g)}const l={};async function q(e){k(e);const t=`https://timeapi.io/api/TimeZone/zone?timeZone=${e}`;try{const a=await(await fetch(t)).json();l[e]={horaBase:new Date(a.currentLocalTime),timestampLocal:new Date};const o=document.querySelector(`.card-skeleton[data-ciudad="${e}"]`);o&&o.remove(),z(e)}catch(n){console.error(n),m&&(m.innerHTML="<p>Error al cargar la hora. Intenta de nuevo.</p>")}}function z(e){const t=l[e];if(!t)return;const a=new Date-t.timestampLocal,o=new Date(t.horaBase.getTime()+a),r={hour:"2-digit",minute:"2-digit",hour12:!0},i={day:"2-digit",month:"2-digit",year:"numeric"},d=o.toLocaleTimeString("es-Ec",r),c=o.toLocaleDateString("es-Ec",i);E(d,e,c)}function I(){const e="https://timeapi.io/api/timezone/availabletimezones",t=JSON.parse(localStorage.getItem("datos")),n=a=>{a.forEach(o=>{const r=document.createElement("option");r.value=o,r.textContent=o,S.appendChild(r)})};t&&n(t),fetch(e).then(a=>a.json()).then(a=>{localStorage.setItem("datos",JSON.stringify(a)),t||n(a)}).catch(a=>console.error("Error al obtnener zonas horarias",a))}function E(e,t,n){const a=document.querySelector(`[data-ciudad="${t}"]`),o=s.querySelector("#list-container"),r=s.getElementById("template-card").content,i=s.createDocumentFragment(),d=s.createElement("img");if(d.src="/img/borrar.png",d.alt="Opciones",d.classList.add("icono-opciones"),a){a.querySelector(".hora").textContent=e,a.querySelector(".fecha").textContent=n;return}let c=s.importNode(r,!0);c.querySelector("[data-ciudad]").setAttribute("data-ciudad",t),c.querySelector(".hour").textContent=e,c.querySelector(".date").textContent=n,c.querySelector(".city").textContent=b(t);const L=c.querySelector(".timezone-icon"),p=w(e);L.textContent=p>=6&&p<=18?"â˜€ï¸":"ðŸŒ•",c.querySelector(".content-opcion").insertAdjacentElement("afterend",d),i.appendChild(c),o.appendChild(i);let u=JSON.parse(localStorage.getItem("zonasGuardadas"))||[];const v={ciudad:t,horaFormateada:e,fechaFormateada:n};u.some(C=>C.ciudad===t)||(u.push(v),localStorage.setItem("zonasGuardadas",JSON.stringify(u)))}function b(e){const t=e.split("/");return t[t.length-1].replace(/_/g," ")}function w(e){const[t,n]=e.split(" "),a=n.replace(/[^a-zA-Z]/g,"").toLowerCase();let[o,r]=t.split(":").map(Number);return a==="pm"&&o!==12&&(o+=12),a==="am"&&o===12&&(o=0),o}function x(){JSON.parse(localStorage.getItem("zonasGuardadas")||[]).forEach(t=>{E(t.horaFormateada,t.ciudad,t.fechaFormateada)})}function N(e){let t=JSON.parse(localStorage.getItem("zonasGuardadas")||"[]");t=t.filter(n=>n.ciudad!==e),localStorage.setItem("zonasGuardadas",JSON.stringify(t))}function k(e){const t=document.getElementById("list-container"),n=document.createElement("div");n.classList.add("card-skeleton","skeleton"),n.setAttribute("data-ciudad",e),n.innerHTML=`
    <div class="skeleton skeleton-line skeleton-title"></div>
    <div class="skeleton skeleton-line"></div>
    <div class="skeleton skeleton-line"></div>
  `,t.appendChild(n)}setInterval(()=>{for(const e in l){const t=l[e],a=new Date-t.timestampLocal,o=new Date(t.horaBase.getTime()+a),r=document.querySelector(`[data-ciudad="${e}"] .hour`),i=document.querySelector(`[data-ciudad="${e}"] .date`);r&&(r.textContent=o.toLocaleTimeString("es-EC",{hour:"2-digit",minute:"2-digit"})),i&&(i.textContent=o.toLocaleDateString("es-EC",{day:"2-digit",month:"2-digit",year:"numeric"}))}},6e4);const f=document,y=f.getElementById("agregarZonaHoraria");f.addEventListener("DOMContentLoaded",()=>{y&&y.addEventListener("click",$),I(),x()});f.addEventListener("click",e=>{if(e.target.matches(".icono-opciones")){const t=e.target.closest(".container-result"),n=t.dataset.ciudad;t.remove(),N(n)}});
